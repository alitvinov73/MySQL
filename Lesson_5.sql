-- Урок 5. Практическое задание по теме «Операторы, фильтрация, сортировка и ограничение»
DROP DATABASE IF EXISTS lesson_5;
CREATE DATABASE lesson_5;
USE lesson_5;

-- Задание 1. Пусть в таблице users поля created_at и updated_at оказались незаполненными. Заполните их текущими датой и временем.

DROP TABLE IF EXISTS `users_1`;
CREATE TABLE `users_1` (
	id INT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY COMMENT "Идентификатор строки",    
	email VARCHAR(100) NOT NULL UNIQUE COMMENT "Почта",
	phone VARCHAR(100) NOT NULL UNIQUE COMMENT "Телефон",
	created_at DATETIME COMMENT "Время создания строки",
	updated_at DATETIME COMMENT "Время обновления строки"
);
-- генерация данных
INSERT INTO `users_1` VALUES (1,'rashawn73@example.com','250.871.2914x20732','2009-09-02 13:59:50','1976-02-10 05:47:45'),(2,'gerhold.jennie@example.com','(708)188-9546x90053','2010-03-03 21:01:55','1998-05-18 22:14:45'),(3,'octavia12@example.com','1-688-210-7605','1984-09-29 16:47:15','2021-01-07 03:39:51'),(4,'blaze89@example.com','(642)721-5652x279','1993-04-21 05:20:37','2019-11-20 09:54:30'),(5,'kiehn.celia@example.com','807.626.4450','1971-07-03 03:16:00','1999-12-14 19:02:12'),(6,'wilderman.tom@example.com','02481990941','1999-03-25 17:13:02','2001-01-07 10:07:02'),(7,'von.dustin@example.com','010.548.8977','2001-05-07 22:11:54','2020-06-09 03:30:48'),(8,'pouros.pauline@example.net','283.542.4221x824','1992-04-20 10:54:28','1977-10-26 20:11:24'),(9,'bradly.dicki@example.org','269-069-5332','2003-06-19 04:37:58','2002-01-20 20:42:33'),(10,'alta.mills@example.org','074.293.9606x2320','1981-01-14 09:33:22','2009-01-07 15:49:37'),(11,'rick.hartmann@example.net','427-008-3116x62527','1981-02-21 01:32:18','1984-03-05 08:04:46'),(12,'ankunding.isabell@example.net','01228405904','1994-09-04 10:10:21','1982-05-03 18:06:44'),(13,'reilly58@example.net','(900)323-8770','1982-07-30 23:30:32','1997-01-02 21:46:29'),(14,'evangeline.mitchell@example.org','+37(1)1585852120','2003-12-13 05:43:35','2009-02-20 15:19:34'),(15,'wbruen@example.net','953-554-5849x6411','2017-06-19 23:36:45','1994-10-26 00:59:42'),(16,'anna.schulist@example.org','+81(2)4722104580','1993-09-19 23:41:14','2021-05-08 06:20:46'),(17,'carroll.andy@example.com','(258)496-8483x22181','1993-08-20 05:53:47','2009-04-23 16:09:33'),(18,'akub@example.net','699.245.5934x9286','2000-03-09 20:53:42','1996-04-10 04:49:30'),(19,'jrunolfsdottir@example.net','859-105-4433','2010-05-12 03:14:41','2001-04-06 21:55:44'),(20,'earnestine.ankunding@example.net','+41(8)7593094659','1979-12-18 19:38:34','2016-09-04 04:20:08'),(21,'gcrist@example.net','072-231-4707x23106','1996-01-19 20:07:51','1998-02-21 03:26:56'),(22,'kohler.maurine@example.org','1-989-399-4563x6277','2015-07-11 20:00:09','1976-09-03 07:01:49'),(23,'delfina99@example.org','322.945.3496x82662','2011-06-07 22:17:34','2019-07-17 13:03:31'),(24,'lsanford@example.net','851.949.9497x813','1981-11-21 14:33:09','2003-11-27 07:10:06'),(25,'hpouros@example.net','329.032.4337','1993-05-16 12:34:27','1976-05-03 08:49:54'),(26,'estelle70@example.com','564-905-5415x28662','2009-02-20 04:46:24','1992-11-02 18:46:36'),(27,'hills.bobby@example.net','912.134.3660','1982-10-20 08:19:15','2019-07-07 03:38:16'),(28,'emmalee.halvorson@example.com','+50(5)9285858355','2013-10-15 01:11:20','1975-05-05 03:30:23'),(29,'fwuckert@example.org','250-255-9994','2003-03-11 07:51:52','2016-07-18 19:50:29'),(30,'ankunding.wilfredo@example.org','265.364.3326x42800','1992-06-17 17:48:20','1979-12-22 18:56:28'),(31,'ibarton@example.com','(411)969-0023x65472','1991-07-12 15:24:45','2011-11-12 19:58:36'),(32,'dswift@example.net','00627485655','1991-10-13 10:40:36','1971-04-06 13:37:43'),(33,'lauriane41@example.net','1-660-776-1742x619','2000-06-17 22:04:42','1971-02-25 23:18:49'),(34,'dante67@example.com','249.012.2260x566','2004-01-05 15:57:46','2018-07-06 03:22:11'),(35,'lamont.braun@example.net','1-620-972-3378','2014-02-20 05:04:53','1981-05-31 20:55:03'),(36,'ipouros@example.com','094.529.0596x2214','1974-12-20 02:07:59','1975-02-10 03:36:42'),(37,'haley.maverick@example.net','1-242-443-7359x7282','1977-06-03 06:21:10','2002-05-17 05:39:50'),(38,'grayson.blanda@example.net','(525)781-1499','2013-10-24 10:31:29','1996-12-07 10:23:57'),(39,'hagenes.mckenna@example.com','1-092-371-6924','1987-03-15 13:30:11','2001-04-14 15:22:48'),(40,'ortiz.coralie@example.com','310-606-8113x46384','1970-10-21 10:59:23','2000-10-03 03:38:45'),(41,'ashleigh83@example.net','066.442.7939x3645','2014-11-23 19:05:11','2007-11-20 08:54:56'),(42,'llewellyn.gutkowski@example.org','742.352.5917','2019-04-25 23:49:14','1998-09-13 16:19:05'),(43,'dimitri66@example.org','014-696-9333x4692','1998-01-01 10:22:20','1970-04-29 19:17:36'),(44,'maxwell25@example.org','800.101.9804','1986-08-15 19:02:17','1983-11-06 05:15:44'),(45,'lschinner@example.net','843.845.5435','1982-01-02 01:33:49','1972-03-29 22:16:15'),(46,'turcotte.laverna@example.org','633-839-9831x21095','1994-04-11 17:17:59','1979-02-09 05:20:05'),(47,'adolph.lubowitz@example.org','153.116.5095','2007-02-14 19:02:03','2000-04-05 19:46:09'),(48,'ikreiger@example.net','1-322-542-9750x939','2005-02-16 21:20:13','1972-08-04 02:32:09'),(49,'jerdman@example.net','128-705-7390','1981-11-20 05:46:25','1998-05-10 16:13:16'),(50,'wparisian@example.org','051.653.1001x00593','1986-08-23 12:54:21','1995-05-23 19:47:05'),(51,'rrogahn@example.org','869.629.9004','2016-11-18 20:55:24','1971-05-03 16:45:20'),(52,'celestine.macejkovic@example.org','1-432-799-9041','1974-03-09 22:20:20','1994-06-13 00:06:12'),(53,'alden65@example.org','1-859-230-1296','1993-10-28 23:39:39','2002-10-24 12:33:14'),(54,'gaylord.jermaine@example.com','349-539-4680x878','2001-07-23 05:34:10','2013-08-17 20:21:02'),(55,'aprohaska@example.net','1-552-217-3026x2694','2020-03-25 08:31:48','1974-01-04 01:46:33'),(56,'price.pierce@example.net','+06(1)8186707566','2019-11-22 23:09:03','2010-08-07 17:41:48'),(57,'carlo21@example.org','677.240.2476x8181','2009-01-09 02:39:12','2014-04-27 08:03:23'),(58,'kpowlowski@example.net','849.679.9715','2005-08-16 09:04:18','1978-07-20 21:26:54'),(59,'tmoen@example.com','367.490.9652','2000-01-02 08:19:33','1997-08-20 10:45:20'),(60,'idouglas@example.org','+48(1)6179997938','2004-09-14 00:26:35','2013-12-10 13:30:55'),(61,'ho\'kon@example.com','(319)635-7731','1986-04-17 09:19:50','2000-04-04 22:53:50'),(62,'krajcik.kenyatta@example.net','1-101-333-8122x76565','1993-08-26 16:11:33','1970-07-10 11:01:08'),(63,'hayes.gayle@example.net','(891)617-9569x5370','2020-01-29 01:19:08','1979-11-21 04:13:25'),(64,'florian.wintheiser@example.net','562-679-5469','1985-03-31 16:58:03','1971-02-25 13:25:02'),(65,'jaskolski.nella@example.net','523.277.0671x18318','2011-01-06 18:39:37','2020-04-13 17:59:46'),(66,'uheller@example.org','(962)432-8042','1989-08-18 13:07:12','1984-07-20 16:39:50'),(67,'xgrant@example.net','1-025-629-6205x772','1993-09-18 13:17:13','2009-11-11 00:18:37'),(68,'creynolds@example.org','292.815.9605','2018-01-27 10:20:45','1985-09-22 02:54:20'),(69,'rae09@example.com','(748)557-9415','1986-02-15 22:39:16','2018-12-22 09:41:47'),(70,'jenkins.francisca@example.org','(250)959-8358x4776','1979-06-16 07:30:35','2003-04-29 15:27:57'),(71,'velda.weber@example.org','(844)411-0750x23124','1974-10-19 09:23:50','1979-08-03 17:13:18'),(72,'aflatley@example.org','883.452.0601x514','2003-08-08 00:39:42','1995-01-18 20:07:44'),(73,'bashirian.jamil@example.com','(979)964-6093','1996-06-07 21:06:55','1986-07-10 02:32:10'),(74,'jimmie05@example.com','055-452-4844','2002-03-15 04:17:57','2021-06-14 03:51:15'),(75,'tsawayn@example.net','045-927-4456','1991-05-06 17:50:03','1999-03-05 00:31:02'),(76,'ekuhic@example.net','+33(3)6373019380','1977-01-02 02:25:17','2003-04-08 01:04:40'),(77,'rlangosh@example.com','330.350.1043','1982-06-03 06:33:55','2012-03-29 05:53:10'),(78,'wanda.haag@example.com','1-405-013-9487x26199','2005-11-04 11:57:21','2011-11-24 21:47:30'),(79,'aufderhar.sedrick@example.com','136.764.7434x191','2000-01-07 08:32:01','2007-10-02 03:15:15'),(80,'kilback.meggie@example.com','353-769-0385x282','1991-11-09 14:56:48','1986-05-09 23:55:47'),(81,'kadin05@example.net','014.234.9067','1981-02-01 09:43:11','1977-09-24 07:37:21'),(82,'hartmann.bernadette@example.com','1-566-143-8419x418','2001-01-09 16:56:15','2006-01-10 17:04:01'),(83,'laney83@example.org','971-275-1577','1990-06-29 18:27:36','1999-07-20 10:58:48'),(84,'vicky85@example.net','676.747.9293','1980-01-30 19:21:52','1988-04-06 06:11:50'),(85,'libby.vonrueden@example.org','1-933-953-2033x24530','1999-04-10 12:16:50','2011-12-21 00:37:44'),(86,'domingo13@example.com','059-958-0353','1985-12-07 03:13:05','1990-12-13 23:29:32'),(87,'darron13@example.com','673-993-5368x249','1979-07-06 07:20:39','1990-05-19 16:16:05'),(88,'ernser.beverly@example.com','685.086.3238','2016-11-12 20:24:58','1973-09-17 18:54:55'),(89,'frieda46@example.org','1-864-677-3797','1976-05-20 14:32:25','1984-05-16 08:22:51'),(90,'collier.afton@example.org','1-831-557-3741x97017','1997-03-31 18:50:20','1991-03-23 15:08:49'),(91,'neva83@example.org','06642164344','2016-05-27 10:58:37','1980-05-25 03:38:34'),(92,'heathcote.era@example.com','1-837-449-6907','2017-07-24 16:16:32','2018-03-26 00:07:30'),(93,'tbogisich@example.net','+57(8)4520731792','2008-04-30 21:10:07','2017-05-31 20:29:59'),(94,'verda43@example.org','1-687-725-1192','1979-09-29 15:32:27','1978-05-26 16:24:39'),(95,'vicente.grant@example.org','(057)790-0541x50305','2006-02-09 13:39:09','1999-08-24 04:28:38'),(96,'fyundt@example.org','761.265.7864x733','2020-06-29 23:39:02','1970-07-11 04:31:40'),(97,'justus.boyle@example.org','+14(0)0119927353','1989-01-25 10:45:15','1984-07-17 18:26:30'),(98,'kozey.hiram@example.net','1-686-180-5183x26121','1983-01-12 17:56:25','1994-03-30 07:40:36'),(99,'abernathy.loyal@example.com','+00(6)2631980065','2000-08-06 01:47:26','2013-07-02 05:20:30'),(100,'upton.callie@example.org','573.464.4985x5091','1977-03-12 09:05:34','1998-01-04 10:16:12');
UPDATE `users_1` SET created_at = NULL, updated_at  = NULL; 	-- генерация ошибки логики данных - незаполненные поля дат
select * from `users_1` limit 10;  							-- проверка наличия ошибки
UPDATE `users_1` SET created_at = CURRENT_TIMESTAMP, updated_at  = CURRENT_TIMESTAMP; 	-- выполнение задания: заполнение полей дат текущим временем и датой
select * from `users_1` limit 10;  							-- проверка выполнения задания

-- Задание 2. Таблица users была неудачно спроектирована. Записи created_at и updated_at были заданы типом VARCHAR и в них долгое время помещались значения в формате 20.10.2017 8:10. Необходимо преобразовать поля к типу DATETIME, сохранив введённые ранее значения.

DROP TABLE IF EXISTS `users_2`;
CREATE TABLE `users_2` (
	id INT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY COMMENT "Идентификатор строки",    
	email VARCHAR(100) NOT NULL UNIQUE COMMENT "Почта",
	phone VARCHAR(100) NOT NULL UNIQUE COMMENT "Телефон",
	created_at VARCHAR(16) COMMENT "Время создания строки",
	updated_at VARCHAR(16) COMMENT "Время обновления строки"
);
SHOW COLUMNS FROM `users_2`; -- просмотр неверно спроектированной таблицы по типам данных

-- генерация данных
INSERT INTO `users_2` VALUES (1,'daniella.herman@example.net','415.789.6651x15866','2001-07-31 04:54','1983-03-11 03:36'),(2,'donnelly.dahlia@example.org','051.411.9149x51389','1984-05-10 10:36','1975-06-15 21:47'),(3,'werner94@example.net','438.925.6802x12729','2005-10-22 03:21','1972-09-14 10:59'),(4,'aiden.carroll@example.org','(806)559-2936','1997-09-28 12:21','1993-11-13 11:01'),(5,'josefina85@example.com','(769)388-8304x206','2017-04-12 14:43','1989-01-22 12:57'),(6,'malcolm.towne@example.org','08748521300','2010-12-08 13:42','2004-07-12 19:43'),(7,'wisozk.aurore@example.com','1-286-276-4806x01716','2016-11-05 11:07','1975-06-17 05:28'),(8,'nheathcote@example.org','1-251-480-2021x01973','2011-04-06 03:13','2007-09-16 11:55'),(9,'monserrat54@example.com','1-009-205-8420','1980-09-06 14:17','1989-05-20 12:15'),(10,'rosalee.rempel@example.com','466.403.2027x00577','2007-11-05 03:41','1980-03-05 19:31'),(11,'hudson.shields@example.net','988-825-2201x044','1993-05-27 03:41','2012-01-10 04:48'),(12,'stefan.kuphal@example.com','901.078.5323x9177','1998-07-21 12:09','1976-07-21 10:59'),(13,'bianka26@example.net','450-530-3236','1988-11-18 23:18','1972-03-01 05:26'),(14,'kole.nitzsche@example.net','(603)616-1229','2003-09-12 05:14','2004-06-24 11:21'),(15,'gleason.cary@example.com','1-363-708-8344','1983-07-20 22:15','1994-12-01 13:34'),(16,'rogahn.conrad@example.org','212-145-8125x29369','2019-09-14 15:47','2018-12-06 10:42'),(17,'pablo49@example.com','782.033.8693x038','1991-03-26 08:32','2000-12-22 10:35'),(18,'lind.marc@example.net','812-245-3458','1996-06-07 15:55','2007-06-17 22:29'),(19,'larissa.osinski@example.net','239.165.1043','1980-03-29 00:02','1984-10-31 04:02'),(20,'saul.terry@example.net','(881)736-4326x4339','2012-06-23 08:03','2019-06-11 00:23'),(21,'yessenia07@example.com','058.615.3729x0609','1973-07-22 08:57','1991-05-03 21:19'),(22,'okuneva.asia@example.net','+70(8)1001545163','2020-03-27 16:50','1976-02-19 12:20'),(23,'alize92@example.net','432.281.5290x2799','2020-02-09 12:08','1994-01-08 20:21'),(24,'schmeler.donny@example.com','111-775-3559','1978-05-18 19:58','2006-02-21 02:27'),(25,'silas.reilly@example.org','08310688532','1980-04-02 08:21','1971-05-11 00:25'),(26,'mlabadie@example.com','1-850-050-8772','2015-02-20 06:44','1970-07-09 15:50'),(27,'bessie43@example.org','609-291-4976','2006-09-12 18:52','1999-03-08 10:10'),(28,'trudie49@example.com','(688)311-2616','2010-12-05 20:53','2005-09-28 00:24'),(29,'cummerata.august@example.org','+97(0)5696273525','1996-07-24 23:30','1987-01-16 04:22'),(30,'rvon@example.org','1-308-878-1824','2004-10-05 02:42','1973-10-20 11:41'),(31,'dooley.tevin@example.net','1-949-156-4838x786','2013-03-11 19:11','2007-11-16 19:06'),(32,'waters.emerald@example.com','(285)389-9783','2017-09-27 18:35','2010-05-13 10:32'),(33,'kub.blake@example.net','1-014-423-5789x587','2016-11-21 13:59','1973-09-13 23:00'),(34,'schristiansen@example.org','07795432992','2013-12-17 23:22','2016-12-11 20:22'),(35,'lonzo.emmerich@example.org','+13(0)0078039573','2002-11-12 09:53','2011-08-04 03:19'),(36,'lcarter@example.net','1-470-892-1866x96768','2020-10-23 17:40','1981-11-17 18:34'),(37,'gkessler@example.net','(710)879-8041x751','2019-01-09 13:24','1976-09-07 18:48'),(38,'jermaine37@example.com','+65(4)5243995734','1985-12-19 03:20','1998-05-15 22:02'),(39,'yklein@example.net','067-464-1896x814','1990-09-18 09:18','1994-08-24 10:44'),(40,'damian84@example.org','571-257-7019x486','1984-11-25 23:15','2012-04-19 18:26'),(41,'demario19@example.org','+55(3)3366256345','2018-05-08 15:23','2007-06-16 04:47'),(42,'colin16@example.org','(511)013-9050x37919','1996-12-24 01:29','1973-02-20 06:46'),(43,'madaline91@example.org','1-354-553-4576x93677','1992-04-09 21:36','1995-06-06 15:56'),(44,'jblanda@example.net','121-549-4909','2008-06-23 23:25','2007-11-01 04:33'),(45,'bailee23@example.com','1-017-459-3676','1973-02-27 15:08','1984-07-15 16:25'),(46,'nrenner@example.org','1-438-158-1714x549','2010-02-19 06:48','1972-10-16 05:36'),(47,'ijohns@example.com','996-024-7202x45694','1984-08-13 09:33','1981-07-20 00:46'),(48,'gmayert@example.net','1-592-489-1589x7570','1989-10-27 00:36','2014-09-03 23:00'),(49,'fmoen@example.org','1-863-784-5739x5069','1975-11-22 17:41','1985-11-13 01:08'),(50,'areichert@example.net','(222)917-2960x91214','1976-07-08 23:33','2008-08-27 07:14'),(51,'ernest12@example.com','774-712-2030','1993-07-04 22:45','1986-12-12 23:58'),(52,'crenner@example.com','(874)308-9031x89253','2016-10-07 04:31','2008-11-14 14:54'),(53,'wbeier@example.org','703.376.6185x7377','1992-02-22 05:42','1985-01-04 23:18'),(54,'lwuckert@example.org','300-088-9572','2012-03-12 14:19','1985-06-09 03:28'),(55,'xbeahan@example.com','(440)534-5318x87082','2019-11-05 21:32','2007-09-29 01:20'),(56,'umuller@example.com','1-017-601-8393x3188','2018-11-14 22:46','1971-10-09 11:26'),(57,'aylin.dicki@example.org','537.085.3067x965','1990-07-20 06:34','1986-02-14 08:49'),(58,'theodore.aufderhar@example.net','05443331441','1996-02-12 07:12','1976-03-22 17:27'),(59,'keely94@example.net','735.363.5561x7601','1971-05-06 01:39','2004-09-14 14:22'),(60,'eriberto14@example.org','03151702494','2014-06-06 06:31','2010-11-16 16:21'),(61,'marvin.wilkinson@example.com','018.249.1203x427','1994-10-04 07:21','2002-09-03 02:30'),(62,'morissette.nick@example.com','676.299.3765x18753','2016-03-28 14:46','1991-11-27 06:51'),(63,'kenya.bruen@example.net','(511)418-6156x4328','2018-12-30 12:00','2008-07-29 16:38'),(64,'huel.nayeli@example.org','(890)419-2166x7445','1983-09-02 12:29','2015-01-09 08:38'),(65,'hansen.elouise@example.com','1-713-039-7193x19948','1975-03-28 12:55','2018-05-03 02:38'),(66,'duncan19@example.org','852-385-3978','1981-11-18 17:18','2004-07-19 22:09'),(67,'ryan.caroline@example.com','(768)854-9355','1986-01-10 04:23','1978-09-06 19:09'),(68,'alayna.aufderhar@example.com','013-812-5409x8131','1974-09-28 13:01','2014-04-17 11:10'),(69,'kayli69@example.org','(894)319-1212x571','2014-08-26 15:01','1998-10-25 00:03'),(70,'evangeline27@example.net','1-467-546-4010','2018-11-13 07:54','1989-08-19 10:52'),(71,'uswift@example.org','1-013-119-2013x012','2001-10-10 06:55','2006-07-16 15:13'),(72,'ihintz@example.org','+12(8)4503444405','2004-01-31 12:56','1975-01-16 20:55'),(73,'weissnat.sunny@example.net','(996)398-3971x0095','1990-12-01 11:23','2006-11-07 20:14'),(74,'kmedhurst@example.org','334-921-9722','1971-08-29 06:10','1988-09-07 09:14'),(75,'felipe.hammes@example.com','765.043.1647x00595','2008-02-22 23:37','2017-10-20 00:24'),(76,'weimann.mireille@example.net','1-140-531-1421x923','1974-06-27 08:57','2009-05-31 00:44'),(77,'rigoberto44@example.net','(042)024-8663x47326','2009-09-24 08:38','2000-09-23 17:43'),(78,'dietrich.ressie@example.org','167-457-4696x388','2008-07-31 06:35','1973-07-02 12:47'),(79,'kyle.huels@example.net','(524)152-2468x054','1993-01-28 17:13','2015-01-16 00:01'),(80,'fanderson@example.net','503-143-2969','2006-06-27 05:11','1991-02-28 20:41'),(81,'brielle91@example.net','919-375-3333x344','2015-08-30 10:08','1984-03-08 11:43'),(82,'conner17@example.org','1-138-654-5270x043','2001-07-27 18:35','1991-07-02 17:16'),(83,'brisa86@example.net','285.681.2137','2009-06-15 00:35','2016-08-01 17:01'),(84,'loma.parker@example.com','125.554.2383','1990-06-06 02:44','2004-12-21 21:27'),(85,'mbechtelar@example.net','(435)516-2166x411','1985-08-23 02:53','2010-08-06 11:01'),(86,'taryn.ryan@example.net','(213)133-5209x2430','2001-05-30 08:39','1980-04-30 05:36'),(87,'veum.kaley@example.org','(327)154-9870x25650','2003-02-01 15:12','2015-05-27 22:57'),(88,'garry96@example.org','867-643-2951','2009-05-28 06:44','1976-06-21 00:01'),(89,'ihaag@example.com','520-064-8527x9394','1977-10-21 05:58','2000-05-20 12:13'),(90,'vicente37@example.net','557-630-2707','1976-01-16 12:13','1984-05-07 17:01'),(91,'gwiegand@example.com','+65(1)2970157160','1995-12-07 14:09','1976-02-28 15:07'),(92,'margaret49@example.org','(957)551-2852x1935','1985-06-18 19:48','2015-12-03 06:06'),(93,'murphy.guido@example.net','(915)469-4856','1979-11-08 19:27','2014-04-07 10:31'),(94,'grice@example.net','+56(2)6902164846','1988-01-08 14:48','1978-05-26 22:59'),(95,'javier.morar@example.com','189-516-9338','1980-02-19 01:12','1996-02-20 21:44'),(96,'adolf.fritsch@example.net','021.479.1366x26834','1981-08-27 23:27','2012-09-02 13:49'),(97,'katheryn.abernathy@example.org','120.236.1454','2016-06-25 15:00','2011-08-08 01:03'),(98,'ahettinger@example.net','312-087-8634','2009-06-09 15:24','1988-08-03 00:17'),(99,'vwindler@example.net','1-534-270-5935','2014-05-04 02:10','2019-03-12 11:06'),(100,'eunice02@example.com','+54(9)3083258663','2014-11-07 13:48','2014-10-31 13:20');
-- просмотр ошибочных данных
SELECT * FROM `users_2` LIMIT 10;
ALTER TABLE `users_2` MODIFY COLUMN created_at DATETIME; -- изменение типа данных
ALTER TABLE `users_2` MODIFY COLUMN updated_at DATETIME; -- изменение типа данных

SHOW COLUMNS FROM `users_2`; -- проверка измения типа данных



/*
Задание 3. В таблице складских запасов storehouses_products в поле value могут встречаться самые разные цифры: 0, если товар закончился и выше нуля, если на складе имеются запасы. 
-- Необходимо отсортировать записи таким образом, чтобы они выводились в порядке увеличения значения value. Однако нулевые запасы должны выводиться в конце, после всех записей.
*/

DROP TABLE IF EXISTS `storehouses_products`;
CREATE TABLE `storehouses_products` (
	id INT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY COMMENT "Идентификатор строки",    
	value INT NOT NULL COMMENT "Остаток на складе",
	name_product VARCHAR(100) NOT NULL UNIQUE COMMENT "Наименование продукта",
	height INT NOT NULL COMMENT "Время создания строки",
	weight INT NOT NULL COMMENT "Время обновления строки"
);

-- генерация данных с нулевыми значениями в поле value
INSERT INTO `storehouses_products` VALUES (1,9,'laudantium',9,3),(2,8,'vel',7,4),(3,9,'praesentium',1,3),(4,0,'delectus',8,4),(5,2,'a',8,4),(6,4,'non',3,1),(7,3,'quia',6,6),(8,2,'eum',2,9),(9,9,'voluptate',6,6),(10,2,'sed',1,9),(11,2,'qui',9,4),(12,6,'velit',4,2),(13,5,'nulla',5,1),(14,1,'necessitatibus',6,7),(15,0,'sapiente',1,1);

-- сортировка, нулевые значения в конце, сортировка по имени в порядке возрастания
SELECT 
	*
FROM 
	`storehouses_products` 
ORDER BY 
	IF(`value` > 0, 0, 1), `value`, name_product ASC;


-- Задание 4. (по желанию) Из таблицы users необходимо извлечь пользователей, родившихся в августе и мае. Месяцы заданы в виде списка английских названий (may, august)

DROP TABLE IF EXISTS `users_3`;
CREATE TABLE `users_3` (
	id INT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY COMMENT "Идентификатор строки",    
    name VARCHAR(55) NOT NULL UNIQUE COMMENT "Имя пользователя",
	email VARCHAR(100) NOT NULL UNIQUE COMMENT "Почта",
	phone VARCHAR(100) NOT NULL UNIQUE COMMENT "Телефон",
    birthday VARCHAR(15) COMMENT 'Месяц рождения',
	created_at VARCHAR(16) COMMENT "Время создания строки",
	updated_at VARCHAR(16) COMMENT "Время обновления строки"
);

-- генерация данных
INSERT INTO `users_3` VALUES (1,'Gillian Gleason','bdietrich@example.net','(923)420-6286','September',NULL,NULL),(2,'Ms. Elta Kunde','devon17@example.com','687-188-6839','October',NULL,NULL),(3,'Allie O\'Conner Jr.','windler.gerson@example.org','706.906.6076','November',NULL,NULL),(4,'Clair Carroll','sharon.little@example.net','453.186.8317x7067','May',NULL,NULL),(5,'Julie Larkin','otto.bode@example.net','+65(3)0193159632','August',NULL,NULL),(6,'Adriel Haag DDS','oswaldo10@example.net','468.007.5599x96211','May',NULL,NULL),(7,'Yesenia Armstrong','bergstrom.kaleigh@example.org','+49(0)5950425215','September',NULL,NULL),(8,'Rickey Abshire','vallie.cartwright@example.org','528-036-8154x537','September',NULL,NULL),(9,'Ewald Kertzmann','schaefer.jaqueline@example.net','300.543.7573x18493','May',NULL,NULL),(10,'Efrain Gleichner','freddie.gottlieb@example.org','03103681451','December',NULL,NULL),(11,'Prof. Kaleigh Schmeler','ajaskolski@example.net','1-188-625-1511x37546','January',NULL,NULL),(12,'Colby Schulist','lou.grady@example.com','(776)097-1721x5621','January',NULL,NULL),(13,'Otho Dickens','o\'connell.valentine@example.com','1-612-296-9097','May',NULL,NULL),(14,'Malika Crist','kovacek.alessandra@example.com','160-314-5102x813','October',NULL,NULL),(15,'Terrance Buckridge','jan.lakin@example.com','1-376-568-6134','February',NULL,NULL),(16,'Miss Verona Wisoky III','aron23@example.org','280.407.7592x871','April',NULL,NULL),(17,'Bernice Reichert DDS','xkulas@example.com','068.694.6757x5862','April',NULL,NULL),(18,'Emmie Lockman','gbruen@example.net','1-046-464-1398x12921','February',NULL,NULL),(19,'Ressie Bartell','zhayes@example.com','867.149.9314x711','August',NULL,NULL),(20,'Braeden Lesch','ehintz@example.net','1-620-305-4627x13610','October',NULL,NULL),(21,'Prof. Broderick Johnson','paucek.wilson@example.com','1-116-133-4358','May',NULL,NULL),(22,'Jewell Haley','ida24@example.net','122.974.2944','January',NULL,NULL),(23,'Dr. Brian Hauck II','osvaldo.ebert@example.com','+81(7)6490566478','November',NULL,NULL),(24,'Miss Karelle Kemmer','schmitt.kayleigh@example.org','(444)199-4350x3281','June',NULL,NULL),(25,'Ms. Amiya Harber','carolina.prosacco@example.org','341.665.7160','July',NULL,NULL),(26,'Dr. Brennon Roob','mertz.curtis@example.net','1-701-951-7991x4189','May',NULL,NULL),(27,'Annabell Hagenes III','timmothy19@example.org','177-909-1435','July',NULL,NULL),(28,'Vincent Abernathy','kerluke.alexa@example.net','(374)766-7945x61784','February',NULL,NULL),(29,'Uriah Deckow','jerde.amelie@example.com','897-144-5322x25941','May',NULL,NULL),(30,'Dr. Pauline Halvorson II','watsica.joyce@example.net','03924839488','November',NULL,NULL),(31,'Ms. Onie Volkman PhD','rodriguez.adam@example.net','1-755-004-2281','November',NULL,NULL),(32,'Mr. Cletus Ernser V','kunze.manuela@example.com','+59(5)3594660351','May',NULL,NULL),(33,'Vincent Lehner DDS','amira41@example.org','459-623-4877x9417','September',NULL,NULL),(34,'Sarai Friesen','doug78@example.net','176-571-7859','March',NULL,NULL),(35,'Marcelle O\'Keefe DDS','toy.mathias@example.net','1-133-953-2693x13358','December',NULL,NULL),(36,'Prof. Antoinette Russel II','brenden80@example.net','+19(2)1667451097','June',NULL,NULL),(37,'Mr. Dylan Bergstrom Jr.','smith.trevor@example.org','1-053-128-5482x14435','May',NULL,NULL),(38,'Miss Duane Emmerich I','evalyn.walsh@example.com','004-827-5337','February',NULL,NULL),(39,'Ms. Camille Larkin','schulist.jordan@example.com','(012)347-7250','May',NULL,NULL),(40,'Jazmin Kilback','pearline.gutmann@example.org','+72(7)3608470307','September',NULL,NULL),(41,'Prof. Collin Schulist','sydni.cartwright@example.org','1-957-654-1568','August',NULL,NULL),(42,'Rebecca Fahey','cassin.erna@example.net','108.356.3868x92405','October',NULL,NULL),(43,'Bud Rodriguez DDS','hillard72@example.org','1-739-198-9179x0286','September',NULL,NULL),(44,'Amber D\'Amore','rippin.julio@example.net','1-398-753-3847','May',NULL,NULL),(45,'Jaylon Daniel','brandt68@example.com','1-448-146-0210x71166','November',NULL,NULL),(46,'Vince Jerde','ima45@example.com','693-340-1897x169','November',NULL,NULL),(47,'Prof. Vince Smitham Sr.','tod.willms@example.net','(350)718-8683','April',NULL,NULL),(48,'Daphnee Thompson','khalid.mayer@example.org','143-941-3118x184','July',NULL,NULL),(49,'Antonette Crona','hanna.brekke@example.net','+26(9)6497856997','May',NULL,NULL),(50,'Emilia Becker','missouri37@example.org','554-379-7988x90581','July',NULL,NULL),(51,'Alf Huels','zulauf.elise@example.com','(376)420-8734x24890','February',NULL,NULL),(52,'Hosea Upton','eleanore.bogan@example.org','1-282-186-1839x957','January',NULL,NULL),(53,'Assunta Toy','amy.stoltenberg@example.com','371.433.0571','January',NULL,NULL),(54,'Ms. Daphney Bashirian','buck23@example.org','(459)733-4834x76803','April',NULL,NULL),(55,'Abdullah Moore','rswaniawski@example.net','(026)063-6258x0059','June',NULL,NULL),(56,'German Hartmann IV','paucek.fiona@example.com','874.732.1649x4938','October',NULL,NULL),(57,'Annabel Blanda','corwin.annie@example.org','(788)661-0630','August',NULL,NULL),(58,'Prof. Forrest Runolfsson V','harris.lila@example.net','(435)728-6718x5131','December',NULL,NULL),(59,'Theresa Kunze III','slesch@example.net','(103)356-2304','February',NULL,NULL),(60,'Justice Botsford','marta.adams@example.com','(104)936-1460','April',NULL,NULL),(61,'Hudson Heller','jquitzon@example.com','1-217-705-2136','July',NULL,NULL),(62,'Taylor Denesik','homenick.timothy@example.net','1-732-639-1941','December',NULL,NULL),(63,'Kiera Stroman','kayleigh91@example.com','1-335-811-9694x6420','February',NULL,NULL),(64,'Leann Kuphal','shaniya69@example.com','489.669.3308x782','March',NULL,NULL),(65,'Shyann Hoppe PhD','devonte.lynch@example.com','595.429.6724x475','June',NULL,NULL),(66,'Kaia Schowalter DVM','candido72@example.org','(439)249-0085x886','September',NULL,NULL),(67,'Catalina Price','jovanny.toy@example.org','382.359.7021','June',NULL,NULL),(68,'Mr. Sebastian Streich I','eskiles@example.org','1-699-253-8751','September',NULL,NULL),(69,'Jeffry Wehner','jessica.boehm@example.org','+29(9)4111403861','August',NULL,NULL),(70,'Felicita Fay','mratke@example.com','102.470.5462','May',NULL,NULL),(71,'Roel Kiehn','rosemary.brakus@example.com','(970)992-2916','July',NULL,NULL),(72,'Dr. Brianne Emmerich IV','slueilwitz@example.com','(121)197-8034x33322','August',NULL,NULL),(73,'Lauriane Ullrich','beryl60@example.org','(726)282-2474x4588','August',NULL,NULL),(74,'Peter Predovic','hudson.anais@example.com','(097)155-0087','May',NULL,NULL),(75,'Rodolfo Erdman','wisozk.donna@example.net','441.878.0488x01129','June',NULL,NULL),(76,'Mr. Brenden Leannon IV','christelle.schuster@example.org','043.718.1590','November',NULL,NULL),(77,'Micah Shields','lyla.bartoletti@example.net','(932)335-1413','April',NULL,NULL),(78,'Meggie Padberg','erica.jacobson@example.com','(390)207-2525','August',NULL,NULL),(79,'Luisa Gusikowski','hand.tyra@example.net','518-214-6390x218','July',NULL,NULL),(80,'Rosalyn Dach','aschultz@example.org','(799)389-7147x6476','May',NULL,NULL),(81,'Mrs. Tara McLaughlin','prath@example.org','1-038-225-7050x306','July',NULL,NULL),(82,'Breana Goldner','baumbach.raphael@example.com','878-485-3382x412','July',NULL,NULL),(83,'Dr. Narciso Schneider Sr.','ylindgren@example.com','1-615-953-7214x811','November',NULL,NULL),(84,'Kristin Blick','lurline56@example.net','775.157.2937','October',NULL,NULL),(85,'Dr. Orrin Dickens III','nelson.rowe@example.org','1-735-208-0307','November',NULL,NULL),(86,'Elza Dickinson','jaleel89@example.com','1-458-534-6926x81681','January',NULL,NULL),(87,'Isaias Hammes I','yaufderhar@example.org','(000)787-5630','October',NULL,NULL),(88,'Dr. Cristal Bergstrom II','zmann@example.net','954.177.3292x176','October',NULL,NULL),(89,'Charles Watsica III','franecki.raoul@example.com','1-217-712-3297x994','July',NULL,NULL),(90,'Davon Jast','rosalinda65@example.com','1-481-839-6230x18066','June',NULL,NULL),(91,'Florencio Beer','lehner.yazmin@example.net','(113)591-7795','January',NULL,NULL),(92,'Ashlee Halvorson','ivory.nienow@example.net','081.462.1326x809','November',NULL,NULL),(93,'Mrs. Kara O\'Conner','pamela09@example.org','(943)233-8722x336','October',NULL,NULL),(94,'Torey Graham','alind@example.org','(685)355-2988x176','April',NULL,NULL),(95,'Ms. Maria Tillman I','kenyatta.champlin@example.org','666.139.3225x5797','April',NULL,NULL),(96,'Rebekah Monahan II','nash61@example.com','1-402-853-1264x5787','February',NULL,NULL),(97,'Brionna Kessler','qtorp@example.net','705.934.9745x7296','July',NULL,NULL),(98,'Ignatius Ullrich','cassie97@example.org','955.909.6147x7843','October',NULL,NULL),(99,'Dr. Eryn Leuschke II','rmclaughlin@example.net','+97(7)8294884657','August',NULL,NULL),(100,'Antwan Miller','watsica.donnell@example.org','215.860.2419x21861','July',NULL,NULL);
-- извлечение информации 
SELECT 
	* 
FROM 
	`users_3` 
WHERE 
	birthday='May' Or birthday='August'
    ORDER BY birthday, name ASC;


-- Задание 5. (по желанию) Из таблицы catalogs извлекаются записи при помощи запроса. SELECT * FROM catalogs WHERE id IN (5, 1, 2); Отсортируйте записи в порядке, заданном в списке IN.
-- продолжаем работать с таблицей users_3 для этого задания.
SELECT 
	* 
FROM 
	`users_3` 
WHERE 
	id IN (5, 1, 2)
    ORDER BY id ASC;

-- сортировка в диапазоне
SELECT 
	* 
FROM 
	`users_3` 
WHERE 
	(id>30 and id <50)
    ORDER BY id ASC;

/*
5. Практическое задание теме «Агрегация данных»
Подсчитайте средний возраст пользователей в таблице users.
Подсчитайте количество дней рождения, которые приходятся на каждый из дней недели. Следует учесть, что необходимы дни недели текущего года, а не года рождения.
(по желанию) Подсчитайте произведение чисел в столбце таблицы.
*/

DROP TABLE IF EXISTS `users_4`;
CREATE TABLE `users_4` (
	id INT UNSIGNED NOT NULL AUTO_INCREMENT PRIMARY KEY COMMENT "Идентификатор строки",    
    name VARCHAR(55) NOT NULL UNIQUE COMMENT "Имя пользователя",
	email VARCHAR(100) NOT NULL UNIQUE COMMENT "Почта",
	phone VARCHAR(12) NOT NULL UNIQUE COMMENT "Телефон",
    birthday DATE COMMENT 'Месяц рождения',
	created_at VARCHAR(16) COMMENT "Время создания строки",
	updated_at VARCHAR(16) COMMENT "Время обновления строки"
);

-- генерация данных
INSERT INTO `users_4` VALUES (1,'Oren Grant V','ward.shanny@example.com','00503296189','2007-08-04',NULL,NULL),(2,'Alexandrine Schoen','rosetta.glover@example.net','+09(7)432430','2007-09-01',NULL,NULL),(3,'Miss Jaida Blanda I','eugenia88@example.org','403-912-5884','2005-02-11',NULL,NULL),(4,'Dr. Jewell Brekke V','valentine.hintz@example.net','1-349-201-93','2004-02-03',NULL,NULL),(5,'Anika Runolfsdottir','marlin52@example.org','1-484-497-64','1987-08-15',NULL,NULL),(6,'Rowland Hamill','qdavis@example.com','1-241-856-56','1988-01-11',NULL,NULL),(7,'Dr. Gerhard Rath III','gwalker@example.org','1-276-037-82','1974-10-29',NULL,NULL),(8,'Kaya Johnson','abe05@example.net','(595)502-997','2013-12-07',NULL,NULL),(9,'Keaton Welch','rowe.shawn@example.net','932-036-4067','1997-09-14',NULL,NULL),(10,'Lurline Jacobi','oo\'keefe@example.net','401-423-0189','1990-05-08',NULL,NULL),(11,'Mrs. Sarah Homenick PhD','dexter80@example.org','08070017429','1993-08-13',NULL,NULL),(12,'Taylor Abernathy','noberbrunner@example.org','945.009.2093','2014-11-29',NULL,NULL),(13,'Mr. Rahul Conroy DVM','percival.jacobson@example.net','(275)421-672','1995-07-11',NULL,NULL),(14,'Javier Block','tristian.gutmann@example.org','111-271-3955','2008-07-28',NULL,NULL),(15,'Prof. Cindy Lindgren','dkertzmann@example.org','024.502.7902','2014-10-24',NULL,NULL),(16,'Prof. Lenore Lubowitz II','khackett@example.org','1-803-868-46','2021-02-25',NULL,NULL),(17,'Fay Harvey','kunze.gudrun@example.net','1-930-267-61','2002-10-20',NULL,NULL),(18,'Shanon Hane','xrolfson@example.org','(923)186-237','1984-11-04',NULL,NULL),(19,'Orlo Green','floyd.ebert@example.org','449-311-9806','1993-06-05',NULL,NULL),(20,'Madge Keebler MD','jarvis.dickens@example.org','659.617.2924','2021-02-24',NULL,NULL),(21,'Miss Dakota Gutmann IV','willie.zboncak@example.com','+21(3)535962','1984-11-26',NULL,NULL),(22,'Beaulah Cole','borer.clyde@example.com','276-576-5678','1970-12-07',NULL,NULL),(23,'Maia Jerde','kshlerin.laurie@example.org','1-830-697-69','2018-01-29',NULL,NULL),(24,'Marian Schaefer DVM','tbode@example.com','520-081-2851','2010-07-13',NULL,NULL),(25,'Damaris Champlin','nola.terry@example.org','1-576-664-89','1971-08-02',NULL,NULL),(26,'Miss Kristina Stiedemann DDS','camden15@example.com','(167)602-848','1987-03-13',NULL,NULL),(27,'Mr. Tyler Gleichner Sr.','harry.herman@example.org','1-834-961-70','2005-06-23',NULL,NULL),(28,'Floyd Kassulke','feest.baylee@example.com','426-989-7504','2016-06-25',NULL,NULL),(29,'Dillan Collier IV','geraldine10@example.com','590-513-8585','2011-08-29',NULL,NULL),(30,'Prof. Diamond Harris DDS','von.cleora@example.com','04206236716','1998-07-07',NULL,NULL),(31,'Lera Graham','rippin.krystina@example.org','08650445175','2017-10-06',NULL,NULL),(32,'Kathlyn Stehr Sr.','rchamplin@example.com','1-089-890-49','2009-06-18',NULL,NULL),(33,'Bonita Kris II','amelie.konopelski@example.org','(018)220-467','1980-03-06',NULL,NULL),(34,'Opal Koch PhD','raynor.kathleen@example.net','1-463-119-33','2012-11-09',NULL,NULL),(35,'Ocie Daugherty','noelia.gutkowski@example.org','276-523-1299','1983-08-05',NULL,NULL),(36,'Yasmin Durgan Sr.','danika.schimmel@example.net','+39(9)940403','2019-12-12',NULL,NULL),(37,'Prof. Werner Osinski','lelia.flatley@example.com','1-475-209-74','2006-11-08',NULL,NULL),(38,'Nicola Jacobson','linnie.aufderhar@example.org','+15(2)030184','2000-07-26',NULL,NULL),(39,'Austen Hegmann','jast.schuyler@example.net','322.197.5777','1970-08-12',NULL,NULL),(40,'Veronica Wiza','giuseppe93@example.org','1-633-609-46','1996-07-17',NULL,NULL),(41,'Prof. Marlin Sipes','stokes.pamela@example.com','615.557.7640','2015-04-21',NULL,NULL),(42,'Katlynn Murray','arnold.ziemann@example.org','+06(9)671203','1993-11-16',NULL,NULL),(43,'Theron Wuckert','larkin.jose@example.org','(350)175-158','2017-01-14',NULL,NULL),(44,'Mrs. Ana Spinka II','chaim00@example.org','(379)686-988','2018-03-17',NULL,NULL),(45,'Mr. Kameron Miller IV','ethelyn10@example.net','626.229.7028','2017-07-06',NULL,NULL),(46,'Macie Bartell','oswald.cronin@example.com','1-588-450-92','2000-03-28',NULL,NULL),(47,'Hassan Schowalter','cwilderman@example.com','1-623-794-40','1987-05-13',NULL,NULL),(48,'Melyna Simonis Jr.','wyatt91@example.org','661-542-2224','2001-07-16',NULL,NULL),(49,'Cassidy Stokes','murphy.kiehn@example.org','03376665169','1982-11-10',NULL,NULL),(50,'Dr. Kyleigh Shanahan','cruickshank.quinten@example.net','376-427-5452','2010-12-06',NULL,NULL),(51,'Jarrett Sanford','smith.alisa@example.org','1-734-847-97','1982-10-24',NULL,NULL),(52,'Treva Hessel','jakubowski.larissa@example.net','713.464.1199','1971-07-01',NULL,NULL),(53,'Mr. Dalton Hessel MD','hauck.luther@example.net','587.864.5311','1985-08-14',NULL,NULL),(54,'Marty Green V','jeffrey.lebsack@example.net','(070)297-954','1987-08-14',NULL,NULL),(55,'Orland Orn','jorge.greenfelder@example.net','09530233995','1988-04-08',NULL,NULL),(56,'Tamara Rowe','nkoch@example.org','(559)222-921','1994-03-02',NULL,NULL),(57,'Mr. Justus Rutherford','abe64@example.org','02373811538','2001-11-08',NULL,NULL),(58,'Elmira Abshire','clangosh@example.com','(768)178-798','2017-12-29',NULL,NULL),(59,'Rashawn Durgan','dibbert.mathew@example.org','288.684.4113','1975-12-23',NULL,NULL),(60,'Hal Fritsch','deontae.pfeffer@example.com','(774)859-821','1998-11-22',NULL,NULL),(61,'Toney Leannon','kshlerin.joanne@example.org','+19(4)227514','2001-11-25',NULL,NULL),(62,'Alanis Lakin','gulgowski.tom@example.org','(538)374-621','1994-10-29',NULL,NULL),(63,'Destiney Ebert','terry.adolf@example.com','1-056-965-32','2018-04-06',NULL,NULL),(64,'Mrs. Lempi Conroy','darwin.heller@example.net','(487)295-610','2018-10-06',NULL,NULL),(65,'Kobe Bauch','effertz.ilene@example.org','336.942.4814','1978-07-07',NULL,NULL),(66,'Alfredo Medhurst','felton.littel@example.org','1-913-743-92','1971-10-03',NULL,NULL),(67,'Hector Pollich','aurelia.williamson@example.org','07064498674','1993-05-22',NULL,NULL),(68,'Verona Hackett DDS','fmohr@example.com','556-948-6090','1993-01-03',NULL,NULL),(69,'Franz Purdy','isabella.deckow@example.org','1-276-511-22','1982-01-15',NULL,NULL),(70,'Lavon O\'Keefe Sr.','casimer63@example.org','626-769-2808','1974-04-25',NULL,NULL),(71,'Dr. Leland Spencer I','norval07@example.com','00823324081','2000-05-11',NULL,NULL),(72,'Casimer Wehner','timmy64@example.net','1-704-475-90','1995-04-25',NULL,NULL),(73,'Mr. Cruz Klein IV','kstokes@example.org','(560)169-413','2015-12-03',NULL,NULL),(74,'Geovanni Adams','ervin04@example.net','1-272-480-11','1991-10-28',NULL,NULL),(75,'Bradley Sawayn Sr.','audreanne03@example.net','+85(6)931444','2000-10-09',NULL,NULL),(76,'Lavina Moore','sbartell@example.net','190.296.6609','1996-05-30',NULL,NULL),(77,'Cora Quigley IV','schiller.eliseo@example.net','250.371.9934','1997-03-03',NULL,NULL),(78,'Clifton Breitenberg','robel.clint@example.net','248-142-9844','2009-06-06',NULL,NULL),(79,'Elenor Smitham','klangosh@example.org','(488)578-099','1990-05-28',NULL,NULL),(80,'Dr. Luciano Huels PhD','dessie.daniel@example.com','061-516-7841','2018-12-12',NULL,NULL),(81,'Miss Vena Miller V','lmiller@example.net','516.105.4127','1971-05-08',NULL,NULL),(82,'Callie Simonis PhD','anjali.stamm@example.com','(755)383-329','1995-06-04',NULL,NULL),(83,'Ms. Cathrine Emmerich','dillon.abshire@example.net','1-709-336-51','1987-10-10',NULL,NULL),(84,'Calista Yundt','sharon.watsica@example.org','742.116.6448','2002-11-19',NULL,NULL),(85,'Talon Keeling','summer.gulgowski@example.net','594.045.6042','1989-04-26',NULL,NULL),(86,'Alberta Powlowski','peffertz@example.net','1-148-697-78','1970-01-24',NULL,NULL),(87,'Prof. Rosalee McKenzie','leilani07@example.com','1-518-813-03','2013-05-30',NULL,NULL),(88,'Santina Thiel','kristopher53@example.net','+20(0)019274','1998-02-10',NULL,NULL),(89,'Mrs. Brigitte Wolff MD','thermiston@example.net','(137)103-554','1992-06-22',NULL,NULL),(90,'Celine Hackett DVM','jewel10@example.com','(649)682-295','1981-11-08',NULL,NULL),(91,'Shyann Hermann','lilliana28@example.net','730.967.2368','1990-03-23',NULL,NULL),(92,'Tyler Grady Sr.','adaline.hayes@example.org','1-349-655-24','1989-05-04',NULL,NULL),(93,'Lorna Jacobi','mabshire@example.org','02580295030','2011-12-16',NULL,NULL),(94,'Fabian Bashirian','walsh.rubye@example.org','752-171-9871','1971-10-01',NULL,NULL),(95,'Javier Sipes','kbednar@example.com','655-095-3505','2016-09-11',NULL,NULL),(96,'Tiara Schaefer','bturcotte@example.com','(513)138-702','1993-08-10',NULL,NULL),(97,'Kristoffer Reichel','teresa.dach@example.org','(745)311-351','2014-10-01',NULL,NULL),(98,'Dr. Antwon Hodkiewicz','howard62@example.net','05047781213','1974-07-03',NULL,NULL),(99,'Mervin Osinski','lelah.howell@example.com','(081)191-221','2007-04-23',NULL,NULL),(100,'Tania Klocko','stephon52@example.com','06611880431','2000-09-15',NULL,NULL);
-- расчет среднего возраста пользователя
SELECT ROUND(AVG((TO_DAYS(NOW()) - TO_DAYS(birthday)) / 365.25), 0) AS AVG_Age FROM `users_4`; -- более точные вычисления
SELECT ROUND(AVG(TIMESTAMPDIFF(YEAR, birthday, NOW())), 0) AS AVG_Age FROM `users_4`; -- округленные до года

-- Подсчитайте количество дней рождения, которые приходятся на каждый из дней недели. Следует учесть, что необходимы дни недели текущего года, а не года рождения.
select 
	DAYNAME(CONCAT(YEAR(NOW()), '-', SUBSTRING(birthday, 6, 10))) AS week_day_of_birthday_in_this_Year,
	COUNT(*) AS amount_of_birthday
FROM 
	`users_4`
GROUP BY 
    week_day_of_birthday_in_this_Year    
ORDER BY
	amount_of_birthday DESC
 ;
 
-- (по желанию) Подсчитайте произведение чисел в столбце таблицы.
DROP TABLE IF EXISTS `my_values`;
CREATE TABLE my_values (
value SERIAL PRIMARY KEY
);

INSERT INTO `my_values` VALUES (1),(2),(3),(4),(5);
select * from my_values;
select round(exp(sum(ln(value)))) from `my_values`;
